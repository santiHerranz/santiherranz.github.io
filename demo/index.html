<!doctype html><html translate="no"><head><title>JSK13 - 2022 - Escape from Death's hole</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="monetization" content="$ilp.uphold.com/ADFQ2LFy9eFi"><style type="text/css">*{box-sizing:border-box;user-select:none}body,html{width:100%;height:100%;margin:0;padding:0}html{background-color:rgba(47,59,50,.52)}body{padding-top:0}#btnAudio{right:0}#btnAudio,#btnSong{position:absolute;top:0;z-index:1;font:24px serif}#btnSong{left:0}#window{margin:0 auto;position:relative;font-family:Arial;box-shadow:0 8px 8px 3px rgba(0,0,0,.5)}@media only screen and (min-width:1024px){#window{width:1024px}}@media only screen and (max-width:768px){#window{width:768px}}@media only screen and (min-width:1536px){#window{width:1536px}}#window-game{width:100%;position:relative}@media only screen and (max-width:768px){#window-game{height:432px}}@media only screen and (min-width:1024px){#window-game{height:576px}}@media only screen and (min-width:1536px){#window-game{height:864px}}#game{width:100%;position:absolute;transform:translateZ(0)}@media only screen and (min-width:1024px){#game{height:576px}}@media only screen and (max-width:768px){#game{height:432px}}@media only screen and (min-width:1536px){#game{height:864px}}</style></head><body><div id="window"><div id="window-game"><canvas id="game"></canvas></div></div><br><div style="text-align: center; font-size: 12px; font-family: Helvetica">Created by <a href="https://github.com/santiHerranz" target="_blank">@santiherranz</a> for the <a href="https://js13kgames.com" target="_blank">js13kGames</a> game jam competition. Inspired by <a href="https://github.com/ferronsays" target="_blank">@ferronsays</a>'s The Last Spartan</div><script type="text/javascript">(t=>{var s={};function i(h){if(s[h])return s[h].exports;var e=s[h]={i:h,l:!1,exports:{}};return t[h].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=t,i.c=s,i.d=(t,s,h)=>{i.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:h})},i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"u",{value:!0})},i.t=(t,s)=>{if(1&s&&(t=i(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.u)return t;var h=Object.create(null);if(i.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var e in t)i.d(h,e,(s=>t[s]).bind(null,e));return h},i.n=t=>{var s=t&&t.u?()=>t.default:()=>t;return i.d(s,"a",s),s},i.o=(t,s)=>({}.hasOwnProperty.call(t,s)),i.p="",i(i.s=3)})([t=>{t.exports={}},function(){const t=CanvasRenderingContext2D.prototype;t.mt=function(t,s){this.moveTo(t,s)},t.lt=function(t,s){this.lineTo(t,s)},t.tr=function(t,s){this.translate(t,s)},t.fr=function(t,s,i,h){this.fillRect(t,s,i,h)},t.s=function(){this.save()},t.r=function(){this.restore()},t.bp=function(){this.beginPath()},t.cp=function(){this.closePath()},t.fs=function(t){this.fillStyle=t},t.ss=function(t){this.strokeStyle=t},t.ft=function(t,s,i){this.fillText(t,s,i)},t.st=function(t,s,i,h=20,e="monospace",r="#fff",n="#000"){this.miterLimit=2,this.font=h+"px "+e,this.ss(n),this.lineWidth=4,this.strokeText(t,s,i),this.fs(r),this.ft(t,s,i)},t.ta=function(t="center"){this.textAlign=t,this.textBaseline="middle"},t.rot=function(t){this.rotate(t)},t.lw=function(t){this.lineWidth=t},t.rr=function(t,s,i,h,e){return 2*e>i&&(e=i/2),2*e>h&&(e=h/2),this.bp(),this.mt(t+e,s),this.arcTo(t+i,s,t+i,s+h,e),this.arcTo(t+i,s+h,t,s+h,e),this.arcTo(t,s+h,t,s,e),this.arcTo(t,s,t+i,s,e),this.cp(),this.fill(),this}},()=>{},function(t,s,i){i.r(s),i(0),i(1);var h=class{constructor(){this._=[],this.v=new C,this.g=0,this.k=0,this.C=0,this.A=!0,this.S=""+f.floor(9999*p()),this.D=1}M(){for(var t=this.v.O(),s=this.P;s;)(t=C.H(t,s.k)).B(s.v),s=s.P;return t}T(){for(var t=this.k,s=this.P;s;)t+=s.k,s=s.P;return t}L(){for(var t=this.g,s=this.P;s;)t+=s.g,s=s.P;return t}R(t){t.P=this,this._.push(t)}F(t){this.k+=this.C*t;for(var s=this._.length;s--;){var i=this._[s];i.F(t),i.A||this._.splice(s,1)}}K(t){var s=this._.length;if(0!==s){for(t.s(),t.tr(this.v.x,this.v.y-this.g),t.rot(this.k);s--;)this._[s].K(t);t.r()}}V(t){t.s(),t.fs("rgba(0,0,0,0.5"),t.bp(),t.ellipse(0,12+this.g,10,5,0,0,2*w),t.fill(),t.r()}},e=0,r=0;class n{constructor(t){this.time=null==t?void 0:e+t,this.setTime=t}set(t=0){this.time=e+t,this.setTime=t}unset(){this.time=void 0}isSet(){return null!=this.time}active(){return e<=this.time}elapsed(){return e>this.time}get(){return this.isSet()?e-this.time:0}p100(){return this.isSet()?((t,s=1,i=0)=>s-i?((t,s=1,i=0)=>i>t?i:t>s?s:t)((t-i)/(s-i)):0)(this.time-e,0,this.setTime):0}}var a=class extends h{constructor(t=new C){super(),this.Z=new C,this.j=new C,this.J=0,this.N=.98,this.W=10,this.I=100,this.U=-1,this.q=1,this.Y=0,this.G=0,this.X=1/0,this.$=-1,this.tt=0,this.it=0,this.ht=!0,this.et=1,this.v=t}get rt(){return this.it+this.g}R(t){t.P=this,this._.push(t)}nt(){this.A=!1,this.at&&this.at.nt(),this.P=void 0}F(t){if(this.A)if(this.tt+=t,0>=this.ot||this.$&&-1!==this.$&&this.tt>=this.$)this.nt();else{var s=this.v.O();this.j.ct(this.q),e<this.G&&this.j.ut(100),this.Z.B(this.j).ct(this.I),this.v.B(this.Z),e>this.G&&(this.Z.ut(.5),this.j.wt()),this.J-=this.N,this.g=f.max(0,this.g+this.J),1>this.g&&(this.J=0,this.C=0),this.ht&&this._t(s),this.dt(),super.F(t)}}K(t){super.K(t),y&&((t,s)=>{1!=s.D&&2!=s.D||(t.s(),t.ss("#fff"),t.bp(),t.mt(s.v.x,s.v.y-s.it),t.lt(s.v.x+40*s.Z.x,s.v.y-s.it+40*s.Z.y),t.stroke(),t.ss("#f0f"),t.bp(),t.mt(s.v.x,s.v.y-s.it),t.lt(s.v.x,s.v.y-s.it-2*s.g),t.stroke(),t.ss("#f00"),t.bp(),t.mt(s.v.x,s.v.y-s.it),t.lt(s.v.x+s.j.x,s.v.y-s.it+s.j.y),t.stroke(),t.r())})(t,this)}pt(t){return Ct.bt.vt&&0!==Ct.bt.vt.gt.length&&t.x<D.x&&t.x>=0&&t.y<D.y&&t.y>=0?Ct.bt.vt.gt[t.y][t.x]:null}_t(t){var s=d(t),i=d(this.v),h=this.pt(i.O().kt());if(!h||!g(this,h.xt)){var e=s.O(),r=C.Ct(i,s),n=r.O();n.y=0;var a=this.pt(C.B(s,n).kt());a&&g(this,a.xt)&&e.B(n);var o=r.O();o.x=0,(a=this.pt(C.B(s,o).kt()))&&g(this,a.xt)&&e.B(o),this.v=_(e),this.Z.B(r.ut(-1))}}dt(){var t=d(this.M()).kt(),s=this.pt(t);if(s){var i=s.yt-this.it;0>i&&g(this,s.xt)&&(this.g+=this.it-s.yt),this.it=s.yt,this.At=s,i>0&&(this.g=f.max(0,this.g-i))}}};class o{constructor(){this.Et=0,this.St=0,this.Dt=[],this.Mt=0,this.Ot=0,this.Pt=[],this.Bt=0,this.Ht=0,this.Tt=0,this.zt=0,this.Lt=0,this.Rt=0,this.Ft=0,this.Kt=0,this.Vt=0,this.Zt=0,this.jt=0,this.Jt=0,this.Nt=[],this.Wt=0,this.It=0,this.Ut=!1,this.qt=!1,this.Yt=!1,this.Gt=0,this.Qt=0,this.Xt=0,this.$t=!1,this.ts=[[o.hs,"#2D2316","#2D2316",o.es,o.rs],[o.hs,"#3D2F1E","#3D2F1E",o.es,o.rs],[o.hs,"#4C3B26","#4C3B26",o.es,o.rs],[o.hs,"#5B462D","#5B462D",o.es,o.rs],[o.hs,"#6B5235","#6B5235",o.es,o.rs],[o.hs,"#7A5E3C","#7A5E3C",o.es,o.rs],[o.hs,"#896A44","#896A44",o.es,o.rs],[o.hs,"#896A44","#896A44",o.es,o.rs],[o.hs,"#896A44","#896A44",o.es,o.rs],[o.hs,"#896A44","#896A44",o.es,o.rs],[o.hs,"#438742","#438742",o.es,o.rs]],this.ns=[],this.as=[[8,8,2,4,4,6,4,6,6,4,0,7,[1],0,0,1,5],[12,12,2,4,7,9,7,9,9,2,0,0,[2,2,2],0,1,0,5],[30,8,5,3,22,2,28,5,10,1,2,2,[8,8,8],10,2,2,10],[10,30,5,25,3,26,5,18,1,12,8,25,[4,6,10],20,3,4,15],[10,30,5,5,3,26,3,26,1,14,2,2,[5,5,5],20,3,4,15],[30,8,25,3,16,1,2,2,15,1,15,6,[5,5,10],10,3,3,20],[30,30,7,14,5,28,4,4,25,4,11,24,[10,5,5],15,5,6,25],[20,20,4,4,18,18,4,16,16,4,12,12,[20,20],15,6,8,30],[25,25,3,22,12,4,12,4,20,20,6,3,[8,10,12],20,3,5,35],[25,25,23,23,20,4,12,12,3,20,4,4,[10,20],20,3,5,40],[20,20,5,7,7,7,0,0,0,0,0,0,[0],0,1,0,0]],this.Et=this.St=0,this.as.forEach((t,s)=>{this.ns.push({c:this.ts[s],os:new C(t[0],t[1]),cs:new C(t[2],t[3]),ls:new C(t[4],t[5]),us:new C(t[6],t[7]),ws:new C(t[8],t[9]),_s:new C(t[10],t[11]),Dt:t[12]||[0],Pt:t[12]||[0],Mt:t[13]||0,Bt:t[13]||0,Ht:t[14]||0,Tt:t[15]||0,Ot:t[16]||0,zt:t[16]||0,Rt:0,Lt:0,Ft:0,Kt:0,Ut:!1})}),this.ds()}get ps(){return this.Et}ds(){const t=this.ns[this.Et];this.Nt=t.c,this.os=t.os,this.vs=t.cs,this.ls=t.ls,this.us=t.us,this.ws=t.ws,this._s=t._s,this.Pt=t.Pt,this.Bt=t.Bt,this.Ht=t.Ht,this.Tt=t.Tt,this.zt=t.zt,this.Ut=t.Ut,this.Rt=t.Rt,this.Lt=t.Lt,this.Ft=t.Ft,this.Kt=t.Kt,this.qt=0==this.Et,this.Yt=this.Et==this.ns.length-1}ms(){this.Et>=0&&this.Et+1<this.ns.length&&(Ct.bt.bs(),this.gs(),this.St=this.Et++)}ks(){this.Et>0&&this.Et-1<this.ns.length&&(Ct.bt.bs(),this.gs(),this.St=this.Et--)}gs(){const t=this.ns[this.Et];t.Ut=this.Ut,t.Rt=this.Rt,t.Lt=this.Lt,t.Ft=this.Ft,t.Kt=this.Kt,t.Pt=this.Pt,t.Bt=this.Bt}xs(){this.Gt=0+this.ns.reduce((t,s)=>t+s.Mt,0),this.Qt=0+this.ns.reduce((t,s)=>t+s.Dt.reduce((t,s)=>t+s,0),0),this.Xt=0+this.ns.reduce((t,s)=>t+s.Ot,0),this.Zt=0+this.ns.reduce((t,s)=>t+s.Rt,0),this.Vt=0+this.ns.reduce((t,s)=>t+s.Lt,0),this.jt=0+this.ns.reduce((t,s)=>t+s.Ft,0),this.Jt=0+this.ns.reduce((t,s)=>t+s.Kt,0),this.$t=!0}}o.Cs="rgba(0,0,0,.5)",o.hs="rgba(0,0,0,0)",o.es="rgba(255,0,0,.3)",o.rs="rgba(0,0,255,.3)";var c=(t,s)=>{if(t==o.hs||t==o.es||t==o.rs)return t;t=t.substr(1);var i=parseInt(t,16),h=f.round(2.55*s),e=(i>>16)+h,r=(i>>8&255)+h,n=(255&i)+h;return"#"+(16777216+65536*(255>e?1>e?0:e:255)+256*(255>r?1>r?0:r:255)+(255>n?1>n?0:n:255)).toString(16).slice(1)},l=class extends a{constructor(t,s,i=0,h,e){super(),this.ys=!1,this.As=!0,i=f.min(200,f.max(i,0)),this.Es=h,this.xt=e,this.Ss=new C(t,s),this.v=_(this.Ss),this.yt=this.Ds=i}K(t){if(Ct.bt.Ms(this.v)){var s=~~this.yt;t.drawImage(this.Es,f.floor(this.xt*(S.x+1)),f.floor(S.y*s+s*(s+1)/2-s),f.floor(S.x),f.floor(S.y+s),f.floor(this.v.x-S.x/2),f.floor(this.v.y-s),f.floor(S.x),f.floor(S.y+s)),y&&(t.fs("#000"),t.bp(),t.ta(),t.ft(this.Ss.x-1+":"+this.Ss.y,this.v.x-S.x/2,this.v.y-2*S.y/3),t.cp(),t.fill())}super.K(t)}},u=(t,s,i,h,e,r=!1)=>{var n=S.x/2,a=S.x/2,o=.5*n+.5*a;t.s(),t.bp(),t.mt(s,i+o),t.lt(s-n,i+o-.5*n),t.lt(s-n,i+o-h-.5*n),t.lt(s,i+o-1*h),t.cp(),t.fs(c(e,-2)),t.ss(c(e,-50)),t.stroke(),t.fill(),t.bp(),t.mt(s,i+o),t.lt(s+a,i+o-.5*a),t.lt(s+a,i+o-h-.5*a),t.lt(s,i+o-1*h),t.cp(),t.fs(c(e,5)),t.ss(c(e,50)),t.stroke(),t.fill(),t.bp(),t.mt(s,i-h),t.lt(s-n,i-h+.5*n),t.lt(s-n+a,i-h+o),t.lt(s+a,i-h+.5*a),t.cp(),t.fs(c(e,-2)),t.ss(c(e,-50)),t.stroke(),t.fill(),r&&(t.fs("#000"),t.bp(),t.ellipse(s,i-h+.5*a,4,2,0,0,2*w),t.cp(),t.fill()),t.r()};const f=Math,w=f.PI;var _=t=>{var s=new C(0,0);return s.x=(t.x-t.y)*S.x/2,s.y=(t.x+t.y)*S.y/2,s},d=t=>{var s=new C;return s.x=t.x/S.x+t.y/S.y,s.y=t.y/S.y-t.x/S.x,s},p=(t=1,s=0)=>f.random()*(s-t)+t,v=()=>2*p()-1,m=(t,s)=>~~(p()*(s-t+1)+t),b=(t,s,i)=>t>=s&&i>=t,g=(t,s)=>null!=s&&(t==Ct.bt.Os||0!=s&&t!=Ct.bt.Os);class k{constructor(t,s,i,h){this.Ps=t||0,this.Bs=s||0,this.Hs=i||0,this.yt=h||0,this.Ts=this.Ps+this.Hs,this.zs=this.Bs+this.yt}set(t,s,i,h){this.Ps=t,this.Bs=s,this.Hs=i||this.Hs,this.yt=h||this.yt,this.Ts=this.Ps+this.Hs,this.zs=this.Bs+this.yt}get mid(){return new C(this.Ps+this.Hs/2,this.Bs+this.yt/2)}}class x{constructor(t=0,s=0){this.x=t,this.y=s}static Ls(){return new x(p(-1,1),p(-1,1))}static B(t,s){return new x(t.x+s.x,t.y+s.y)}static Ct(t,s){return new x(t.x-s.x,t.y-s.y)}static ut(t,s){return s instanceof x?new x(t.x*s.x,t.y*s.y):new x(t.x*s,t.y*s)}static Rs(t,s){return f.sqrt(f.pow(s.x-t.x,2)+f.pow(s.y-t.y,2))}static Fs(t,s){return void 0===s&&(s=1),new x(s*f.cos(t),s*f.sin(t))}static H(t,s){return new x(t.x*f.cos(s)-t.y*f.sin(s),t.x*f.sin(s)+t.y*f.cos(s))}Ks(){return Math.atan2(this.y,this.x)}O(){return new x(this.x,this.y)}Vs(){return f.sqrt(this.x*this.x+this.y*this.y)}Zs(){var t=this.Vs();return t>0?this.ut(1/t):this}ct(t){return this.Vs()>t?(this.Zs(),this.ut(t)):this}B(t){return this.x+=t.x,this.y+=t.y,this}Ct(t){return this.x-=t.x,this.y-=t.y,this}ut(t){return this.x*=t,this.y*=t,this}kt(){return this.x=f.floor(this.x),this.y=f.floor(this.y),this}wt(){return this.x=0,this.y=0,this}}var C=x;const y=!1;var A=768,E=432;1024>innerWidth||(A=1024,E=576),1536>innerWidth||(A=1536,E=864);var S=new C(60,30),D={x:5,y:5};function M(){for(var t="#",s=0;6>s;s++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}const O={js:["#00f"],Js:["#E3C199","#FCDFBE","#C6936E","#9E6A3E","#5A463B"],Ns:"#db0000",Ws:"#fff",Is:"#000"},P={js:["#545943","#531F7C"],Js:["#246837"],Ns:"#262",Ws:"#fcc",Is:"#f00"};var B=class extends a{constructor(t,s){super(t),this.Us=!1,this.qs=s,this.ht=!0}F(t){var s=this.$-this.tt;-1!==this.$&&s<.1*this.$&&(this.et=s/(.1*this.$)),super.F(t)}},H=class extends a{constructor(t,s,i,h,e,r,n,a){super(t),this.g=s,this.J=i,this.Z=h,this.qs=e,this.Ys=r,this.$=n,this.Gs=a,this.dt()}F(t){super.F(t),this.qs+=1*this.Ys/t}K(t){t.fs("rgba(0,0,0,0.5"),t.fr(this.v.x-this.qs/4,this.v.y+this.qs/4-this.it,this.qs/2,this.qs/2),t.fs(this.Gs),t.fr(this.v.x-this.qs/2,this.v.y-this.qs/2-this.rt,this.qs,this.qs),super.K(t)}},T=class extends a{constructor(){super(...arguments),this.Qs=new C,this.Xs=0,this.J=0,this.$s=0,this.ti=0,this.si=0,this.W=0,this.ii=0,this.qs=0,this.hi=0,this.ei=0,this.ri=0,this.ni=0,this.ai=0,this.Gs="#fff",this.oi=0,this.ci=0,this.li=-1,this.ui=!1,this.fi=[]}F(t){if(0===this.li)for(;this.fi.length<this.si;)this.emit();super.F(t),this.fi=this.fi.filter(t=>t.A);var s=this.si/this.ni;if(this.A&&s>0){var i=1/s;for(this.oi+=t;this.fi.length<this.si&&this.oi>i;)this.emit(),this.oi-=i;this.ci+=t,-1!==this.li&&this.li<this.ci&&this.nt()}}emit(){var t=this.Qs.O().ut(v());this.ui&&(t=C.H(t,this.T()));var s=this.ui?this.M():this.v.O();s.x+=t.x,s.y+=t.y;var i=(this.ui?this.T():this.k)+this.ti*v(),h=this.W+this.ii*v(),e=new C(Math.cos(i),Math.sin(i)).ut(h),r=this.qs+this.hi*v();r=0>r?0:~~r;var n=this.ei+this.ri*v();n=0>n?0:~~n;var a=this.J+this.$s*v();a=0>a?0:~~a;var o=this.ni+this.ai*v(),c=(n-r)/o,l=new H(s,this.Xs,a,e,r,c,o,this.Gs);void 0!==this.N&&(l.N=this.N),this.ui?(l.g=this.L(),Ct.bt.wi(l)):this.R(l),this.fi.push(l)}},z=class extends B{constructor(t,s,i){super(t,s),this._i=!1,this.Ws=O.Ws,this.Is=O.Is,this.di=1,this.pi=new n(.1),this.vi=1,this.mi=!1,this.qs=s,null!=i&&(this.Js=i.Js,this.bi=i.bi,this.Ns=i.Ns,this.Ws=i.Ws,this.Is=i.Is),this.gi=new n,this.ki=new n(1)}F(t){this.j.ut(.9),this.Z.ut(.9),this.C*=.9,.005>p()&&this.gi.set(p(.2,.1)),this.ki.elapsed()&&this.ki.set(p(1.5,3)),this.pi.elapsed()&&this.pi.set(p(.2,.8)),super.F(t)}xi(){var t=new T;Object.assign(t,{v:new C(0,this.qs.y/2),k:-Math.PI/4,ui:!0,N:.098,Gs:this.Ns,si:400,J:0,$s:2,qs:2,ei:4,ri:.5,ni:1e3,ai:100,W:0,ii:5,ti:2*Math.PI,li:300,Xs:this.qs.y}),this.R(t)}K(t,s={v:new C,r:0}){super.K(t),t.s(),t.globalAlpha=this.et,t.tr(this.v.x+s.v.x,this.v.y+s.v.y-this.g),this.Us&&this.V(t),t.rot(s.r+this.k),t.ss("#000"),t.bp(),t.fs(this.Js),t.fr(-this.qs.x/2,-this.qs.y,this.qs.x,this.qs.y);let i=.5+.5*f.cos(this.gi.p100()*w*2);this._i&&(i=.2),this.vi=.3+.3*f.cos(this.ki.p100()*w*2),this._i&&(this.vi=-.4),2==this.di?this.Ci(t):this.yi(t),t.fs(this.bi),t.bp(),t.fr(-this.qs.x/2,-this.qs.y,this.qs.x,this.qs.y/4),t.bp(),t.fr(-this.qs.x/2,-this.qs.y,this.qs.x/8,18*this.qs.y/20),this.Ai(t,i),this.mi&&this.Ei(t),t.r()}Ei(t){t.s(),t.tr(3*this.qs.x/9,-this.qs.y),t.fs("rgba(50,255,50,.5)"),t.bp(),t.rect(-this.qs.x/3,+this.qs.y/3,this.qs.x/2,this.qs.y/3),t.fill(),t.bp(),t.ss("#000"),t.lw(1),t.rect(-this.qs.x/3,+this.qs.y/3,this.qs.x/2,this.qs.y/3),t.stroke(),t.r()}yi(t){t.fs("#000"),t.bp(),t.lw(.1),t.s(),t.tr(3*this.qs.x/9,-this.qs.y/8-2),this._i&&t.rot(w),t.arc(0,0,2,.8+this.vi,w-this.vi),t.cp(),t.fill(),t.r()}Ci(t){let s=.3+.3*f.cos(this.pi.p100()*w*2),i=this.qs.x/6,h=this.qs.y/8;t.s(),t.tr(3*this.qs.x/9,-this.qs.y/8),t.fs("#624"),t.bp(),t.rect(-i,-h/2,2*i,h/2+h*s),t.fill(),t.ss("#ff7"),t.lw(1.5),t.setLineDash([3,.5]),t.bp(),t.mt(-h,-1),t.lt(+h,-1),t.stroke(),t.bp(),t.lw(1),t.setLineDash([2,.5]),t.mt(-h,2*s),t.lt(+h,2*s),t.stroke(),t.r()}Ai(t,s){t.ss("#000");const i=this.qs.y/20;t.bp(),t.fs(this.Ws),t.ellipse(this.qs.x/2.25,-this.qs.y+this.qs.y/2,.8*i,2.7*i*s,0,0,2*w),t.cp(),t.fill(),t.bp(),t.fs(this.Is),t.ellipse(.5+this.qs.x/2.25,-this.qs.y+this.qs.y/2,i/2*.8,i/2*2.7*s,0,0,2*w),t.cp(),t.fill(),t.bp(),t.fs(this.Ws),t.ellipse(this.qs.x/4,-this.qs.y+this.qs.y/2,1.1*i,3*i*s,0,0,2*w),t.cp(),t.fill(),t.bp(),t.fs(this.Is),t.ellipse(.5+this.qs.x/4,-this.qs.y+this.qs.y/2,i/2*1.1,i/2*3*s,0,0,2*w),t.cp(),t.fill()}};let L=A/4;const R="rgba(10,10,10,.5)";var F=class extends a{constructor(){super(),this.Si=!1,this.Di=!1,this.Mi=!1,this.Oi=new n(.5),this.Pi=new z(new C,new C(32,36),O),this.Pi.Js=O.Js[Math.random()*O.Js.length>>0],this.Pi.bi=M(),this.Bi=new z(new C,new C(32,36),P),this.Bi.di=2}F(t){super.F(t),this.Oi.elapsed()&&this.Oi.set(.5),this.Pi.F(t),this.Bi.F(t)}K(t){t.fs("rgba(100,100,100,.2)"),t.fr(0,0,A,50);const s=Ct.bt;s.Os&&(t.fs("#fff"),t.fr(A/2-L/2,10,L,20),t.fs("#d11141"),t.fr(A/2-L/2,10,s.Os.ot/s.Os.X*L,20),Ct.Os.Hi.isSet()&&(t.fs("#00aedb"),t.fr(A/2-L/2,35,(1-Ct.Os.Hi.p100())*L,10)));const i=s.Ti;t.st("LEVEL "+i.ps+"/"+(i.ns.length-1),20,30,26),t.textAlign="right";let h=A-A/4;if(t.st("💎 "+i.Lt+"/"+s.Ti.zt,h+180,35,26),Ct.Os.zi){let s=A/6,i=30;t.st("🧭",s+30,i,26)}if(Ct.Os.mi){let s=A/6+70,i=24;t.s(),t.bp(),t.fs("rgba(50,255,50,.5)"),t.mt(s,i),t.arc(s,i,20,0,2*w-2*w*Ct.Os.Li.p100()),t.lt(s,i),t.cp(),t.fill(),t.r(),t.st("🥽",s+18,i+6,26)}if(Ct.Os.Ri){let s=A/6,i=30;t.st("🔑",s+180,i,26)}if(s.Fi.length>0){let i=A/2-L/2-80,h=36;this.Pi.K(t,{v:new C(i,h),r:0}),t.textAlign="left",t.st(":"+s.Fi.length,i+20,30,26)}if(s.Ki.length>0){let i=A/2+L/2+30,h=36;this.Bi.K(t,{v:new C(i,h),r:0}),s.Ti.Pt.reduce((t,s)=>t+s,0),s.Ti.Pt[s.Vi-1],s.Ki.length;let e="";s.Ti.Pt.forEach((t,i)=>{i>s.Vi&&(e+=","+t)}),e="",t.textAlign="left",t.st(":"+s.Ki.length+" "+e,i+20,30,26)}if(this.Mi&&(t.fs(R),t.rr(A/2-A/3,2*E/12-80,2*A/3,100,30),t.ta(),t.st(this.Zi,A/2,2*E/12-40,30)),this.Si&&(t.fs(R),t.rr(40,E/2-E/12,A-80,E/6,30),t.ta(),t.st("Press Enter to try again",A/2-20,E/2,E/12+3*f.cos(this.Oi.p100()))),this.Di){t.fs(R),t.rr(A/2-3*A/4/2,40,3*A/4,300,30),t.ta(),t.st("⭐ YOU ESCAPED! 🎉",A/2-20,100,80+3*f.cos(this.Oi.p100()));let s=40,h=120;t.ta("center"),i.Gt>0&&t.st("Rescued:      "+(i.Zt+" of "+i.Gt).padStart(12," ")+"    "+((100*i.Zt/i.Gt).toFixed(1)+" %").padStart(12," "),A/2-20,h+1*s,30),i.Xt>0&&t.st("Diamonds:     "+(i.Vt+" of "+i.Xt).padStart(12," ")+"    "+((100*i.Vt/i.Xt).toFixed(1)+" %").padStart(12," "),A/2-20,h+2*s,30),i.Qt>0&&t.st("kills: "+i.jt+" zombies and "+i.Jt+" humans",A/2-20,h+4*s,30)}y&&(t=>{let s=2,i=E/40;if(t.ta("left"),t.fs("#fff"),t.fr(9,9+1*i,A/4,4*i),Ct.bt instanceof pt){let h=Ct.bt;if(h.Os){let e="diamonds: "+JSON.stringify(Ct.Ti.Lt),r="maxZombies: "+JSON.stringify(Ct.Ti.Pt),n="zombieWave: "+JSON.stringify(h.Vi);t.st(A+" "+E,10,s++*i,i),t.st(e,10,s++*i,i),t.st(r,10,s++*i,i),t.st(n,10,s++*i,i),t.st(Ct.Ti.Rt,10,s++*i,i)}}})(t)}ji(t){this.Zi=t,this.Mi=!0}Ji(){this.Zi="",this.Mi=!1}},K=class extends a{constructor(t,s={x:5,y:5}){super(),this.gt=[],this.Ni=0,((t=D)=>{D.x=t.x,D.y=t.y})(s);for(var i=D.y;i--;){for(var h=[],e=D.x;e--;){var r;r=new l(e,i,20,t,1),this.R(r),h.push(r)}this.gt.push(h.reverse())}this.gt.reverse()}},V=new class{constructor(){var t=t=>s=>{switch(s.code){case"ArrowRight":case"KeyD":this.Wi=t;break;case"ArrowDown":case"KeyS":this.Ii=t;break;case"ArrowLeft":case"KeyA":this.Ui=t;break;case"ArrowUp":case"KeyW":this.qi=t;break;case"Space":this.Yi=t;break;case"NumpadEnter":case"Enter":this.Gi=t}};window.addEventListener("keydown",t(!0)),window.addEventListener("keyup",t(!1))}};class Z{constructor(t,s){this.Rs=80,this.Qi=576,this.Xi=new C,this.$i=w/4,this.th=new k(0,0,0,0),this.sh=new C(.5,.5),this.ih=!0,this.hh=.15,this.eh=0,this.rh(),this.nh=t,this.ah=s,this.oh=t/s,this.lh=!1,this.uh=100}fh(t){this.eh=t}wh(t){t.s(),this.ut(t),this._h(t)}dh(t){t.r()}ut(t){t.scale(this.sh.x,this.sh.y)}_h(t){t.tr(-this.th.Ps,-this.th.Bs)}F(t){this.eh=f.max(this.eh-t,0),this.ph(this.Rs+.05*(this.Qi-this.Rs))}rh(){this.th.set(this.Xi.x-this.th.Hs/2+(this.eh?6*v():0),this.Xi.y-this.th.yt/2+(this.eh?6*v():0),this.Rs*f.tan(this.$i),this.th.Hs/this.oh),this.sh.x=this.nh/this.th.Hs,this.sh.y=this.ah/this.th.yt}ph(t){this.Rs=t,this.rh()}vh(t,s){var i=new C(t,s);this.ih?this.Xi.Ct(C.Ct(this.Xi,i).ut(this.hh)):this.Xi=i.O(),this.rh()}}class j extends h{mh(t){return this._.filter(s=>this.bh(t,s))}bh(t,s){if(t!==s&&t.gh.S!==s.gh.S)return this.kh(t,s)}kh(t,s){return t.p.x<s.p.x+s.w&&t.p.x+t.w>s.p.x&&t.p.y<s.p.y+s.h&&t.p.y+t.h>s.p.y}}class J extends a{constructor(t,s,i,h,e=-1,r=!1){super(),this.w=i,this.h=h,this.gh=t,this.xh=s||new C,this.F(0),this.$=e,r&&Ct.bt.Ch.R(this)}F(t){super.F(t),this.p=this.gh.v.O().B(this.xh).B(new C(0,-this.gh.g))}K(t){t.s(),t.lw(1),t.ss("#f00"),t.bp(),t.rect(this.p.x,this.p.y,this.w,this.h),t.stroke(),t.r()}}var N=class{constructor(){this.yh=[]}Ah(t){return 0==this.yh.filter(s=>s.n==t).length}Eh(t,s=.3){this.yh.push({n:t,t:e+s})}F(t){this.yh=this.yh.filter(t=>e<t.t)}};let W,I,U;I=.3,W=(t=1,s=.05,i=220,h=0,e=0,r=.1,n=0,a=1,o=0,c=0,l=0,u=0,f=0,w=0,_=0,d=0,p=0,v=1,m=0,b=0)=>{let g,k,x=Math,C=44100,y=2*x.PI,A=o*=500*y/C/C,E=i*=(1-s+2*s*x.random(s=[]))*y/C,S=0,D=0,M=0,O=1,P=0,B=0,H=0;for(c*=500*y/C**3,_*=y/C,l*=y/C,u*=C,f=C*f|0,k=(h=C*h+9)+(m*=C)+(e*=C)+(r*=C)+(p*=C)|0;k>M;s[M++]=H)++B%(100*d|0)||(H=n?n>1?n>2?n>3?x.sin((S%y)**3):x.max(x.min(x.tan(S),1),-1):1-(2*S/y%2+2)%2:1-4*x.abs(x.round(S/y)-S/y):x.sin(S),H=(f?1-b+b*x.sin(y*M/f):1)*(H>0?1:-1)*x.abs(H)**a*t*.3*(h>M?M/h:h+m>M?1-(M-h)/m*(1-v):h+m+e>M?v:k-p>M?(k-M-p)/r*v:0),H=p?H/2+(p>M?0:(k-p>M?1:(k-M)/p)*s[M-p|0]/2):H),g=(i+=o+=c)*x.cos(_*D++),S+=g-g*w*(1-1e9*(x.sin(M)+1)%2),O&&++O>u&&(i+=l,E+=l,O=0),!f||++P%f||(i=E,o=A,O=O||1);return(t=U.createBuffer(1,k,C)).getChannelData(0).set(s),(i=U.createBufferSource()).buffer=t,i.connect(U.destination),i.start(),i},U=new(window.AudioContext||webkitAudioContext);const q=()=>X(2,.4,()=>{W(.3,0,65,.08,0,.28,0,0,1.8,0,50,0,0,0,-2,0,0,.2,0,1)}),Y=()=>X(7,.4,()=>{W(.4,.2,250,.04,0,.04,0,1,1,0,0,0,0,3,0,0,0,1,0,0)}),G=()=>X(10,.4,()=>{W(.03,.5,215,0,.02,.01,2,.1,90.6,0,150,0,0,0,0,0,0,3,.01,.62)});let Q=new N;function X(t,s=.3,i){Q.Ah(""+t)&&(i(),Q.Eh(""+t,s))}class $ extends a{constructor(){super(),this.Ch=new j,this.Sh=!1,this.Dh=!1,this.Mh=!1,this.Oh=new Z(A,E),this.Oh.Rs=5e3,this.Oh.Xi=_(new C(5,5))}F(t){this.Oh.F(t),V.qi?this.Os.j.y-=2:V.Ii&&(this.Os.j.y+=1),V.Ui?this.Os.j.x-=1:V.Wi&&(this.Os.j.x+=1),(Ct.Ph||V.Yi)&&this.Os.Bh()&&(Y(),this.Os.Hh()),!this.Os.Th&&(Ct.Ph||V.Yi)&&this.Os.zh()&&(X(1,.2,()=>{W(.1,0,493,0,0,.25,0,1.61,1,0,286,50,20,0,-.1,0,0,1.1,0,.09)}),this.Os.J+=10,this.Os.j.ut(1.2)),this.Ch.F(t),super.F(t)}wi(t){this.R(t)}Lh(){}Ms(t){return b(t.x,this.Oh.th.Ps-100,this.Oh.th.Ts+100)&&b(t.y,this.Oh.th.Bs-100,this.Oh.th.zs+100)}}var tt=class extends a{constructor(t,s=new C){super(s),this.qs=new C(16,16),this.Rh="",this.Fh=!1,this.Rh=t,this.ht=!0}F(t){this.Fh||(this.at=new J(this,new C(-this.qs.x/2,0-this.g-this.rt),this.qs.x,this.qs.y,50,!0)),super.F(t)}Kh(t){if(!this.A)return;let s=Ct.bt.Os;"🔑"!=this.Rh||t.Ri||(t.Ri=!0,t===s&&Ct.Vh(3,t,this,1),this.nt()),1==t.D&&"💎"==this.Rh&&Ct.Vh(16,t,this,0,t.S),t===Ct.bt.Os&&("🔒"==this.Rh&&t.Ri&&!Ct.Ti.Ut?(this.Fh=!0,Ct.Ti.Ut=!0,Ct.Vh(4,t,this,.1)):"💗"==this.Rh?Ct.Vh(14,t,this,.1,this.S):"🔓"==this.Rh||("🍄"==this.Rh?(s.Zh=1,s.Hi.set(15),this.nt()):"🧭"==this.Rh?(s.zi=!0,this.nt()):"🥽"==this.Rh&&(s.mi||(s.mi=!0,Ct.Vh(18,t,this,.1,this.S),s.Li.set(60),this.nt()))))}K(t,s={v:new C,r:0}){t.s(),t.tr(0,-10),t.tr(this.v.x+s.v.x,this.v.y+s.v.y),this.V(t),t.rot(s.r+this.k),t.fs("rgba(0,0,0,1"),t.bp(),t.ta();let i=this.qs.x+(this.Fh?0:5*f.abs(f.cos(2.5*e)));t.font=i+"px serif",t.ft(this.Rh,0,4),t.r()}},st=class extends tt{constructor(t=new C,s=new C(10,40)){super("",t),this.jh=100,this.qs=s,this.Jh=s.y}Kh(t){!t.Th&&this.A&&1==t.D&&(t.Th=!0,t.Nh=t.Wh.qs=this.qs,t.Wh.Jh=this.Jh,t.Wh.jh=this.jh,t===Ct.bt.Os&&Ct.Vh(2,t,this,.1),this.nt())}K(t,s={v:new C,r:0}){t.s(),t.tr(0,-10),t.lw(1),t.globalAlpha=this.et,t.tr(this.v.x+s.v.x,this.v.y+s.v.y),this.V(t),t.rot(s.r+this.k),t.lw(2),t.fs("#d8d8d8"),t.fr(0,-(this.qs.y-18)/2-8,this.qs.x/2,this.Jh),t.fs("#cccccc"),t.fr(this.qs.x/2,-(this.qs.y-18)/2-8,this.qs.x/2,this.Jh),t.fs("#963"),t.fr(0,-(this.qs.y-6)/2-5,this.qs.x,5),t.fs("#333"),t.fr(this.qs.x/4,-(this.qs.y-6)/2-10,this.qs.x/2,5),t.r()}},it=class{constructor(t,s,i=!0){this.Ih=0,this.Uh=0,this.qh=[],this.Yh=t,this.Gh=i,["b","h","s","lL","lR"].forEach(i=>{for(var h=s[i]||[{f:0},{f:t}],e=1;e<h.length;e++)for(var r=h[e-1],n=h[e],a=n.f-r.f,o=0;a>o;o++){var c=o/a,l=this.qh[r.f+o],u=l||{},f={};if(r.hasOwnProperty("p")){var w=r.p[0]+(n.p[0]-r.p[0])*c,_=r.p[1]+(n.p[1]-r.p[1])*c;f.v=new C(w,_)}else f.v=new C(0,0);if(r.hasOwnProperty("r")){var d=r.r+(n.r-r.r)*c;f.r=d}else f.r=0;u[i]=f,l||this.qh.push(u)}})}get Qh(){return this.qh[this.Uh]}get Xh(){return!this.Gh&&this.Uh===this.Yh-1}F(t){this.Ih+=1,this.Uh=f.floor(this.Ih),this.Uh>this.Yh-1&&(this.Uh=0,this.Ih=0)}};let ht=-w/180*120;var et={h:[{f:0,p:[0,.5]},{f:5,p:[0,0]},{f:20,p:[0,.5]}],b:[{f:0,p:[0,0]},{f:15,p:[0,.5]},{f:20,p:[0,0]}],s:[{f:0,r:ht},{f:10,r:ht-.045},{f:20,r:ht}]},rt={h:[{f:0,r:-.1,p:[3,0]},{f:3,r:-.1,p:[3,2]},{f:7,r:-.1,p:[3,0]},{f:13,r:-.1,p:[3,2]},{f:20,r:-.1,p:[3,0]}],b:[{f:0,r:.1,p:[0,0]},{f:3,r:.1,p:[0,2]},{f:7,r:.1,p:[0,0]},{f:13,r:.1,p:[0,2]},{f:20,r:.1,p:[0,0]}],s:[{f:0,r:ht-.24,p:[5,0]},{f:10,r:ht-.2,p:[3,0]},{f:20,r:ht-.24,p:[5,0]}],lL:[{f:0,r:1.4},{f:10,r:-1.4},{f:20,r:1.4}],lR:[{f:0,r:-1.4},{f:10,r:1.4},{f:20,r:-1.4}]},nt={h:[{f:0,r:-.1,p:[1,4]},{f:3,r:-.1,p:[1,5]},{f:7,r:-.1,p:[1,4]},{f:13,r:-.1,p:[1,5]},{f:16,r:-.1,p:[1,4]}],b:[{f:0,r:.1},{f:16,r:.1}],s:[{f:0,r:-w-.5,p:[0,-20]},{f:4,r:1.5-w,p:[10,0]},{f:16,r:1.6-w,p:[10,0]}],lL:[{f:0,r:0},{f:8,r:1},{f:16,r:0}],lR:[{f:0,r:0},{f:8,r:-1},{f:16,r:0}]},at={h:[{f:0,p:[4,-.5]},{f:20,p:[4,0]}],b:[{f:0,p:[0,0]},{f:20,p:[0,0]}]},ot={h:[{f:0,r:0,p:[5,0]},{f:5,r:0,p:[5,-.5]},{f:20,r:0,p:[5,0]}],b:[{f:0,r:0,p:[0,0]},{f:20,r:0,p:[0,0]}],lL:[{f:0,p:[1,0],r:.1},{f:10,p:[-1,0],r:-.1},{f:20,p:[1,0],r:.1}],lR:[{f:0,p:[-1,0],r:-.1},{f:10,p:[1,0],r:.1},{f:20,p:[-1,0],r:-.1}]},ct=class extends B{constructor(t,s){super(t,s),this.Jh=0,this.$h=0,this.te=20,this.jh=100,this.Jh=s.y}Fh(t){this.$h+=1,this.Jh=this.qs.y-this.qs.y/2*(this.$h/this.te),this.$h>this.te&&(t.Th=!1,this.Jh=this.qs.y,this.$h=0)}F(t){}K(t,s={v:new C,r:0}){super.K(t),t.s(),t.lw(1),t.globalAlpha=this.et,t.tr(this.v.x+s.v.x,this.v.y+s.v.y-this.rt),this.Us&&this.V(t),t.rot(s.r+this.k),t.lw(2),t.fs("#ccf"),t.fr(0,5,this.qs.x/2,this.Jh),t.fs("#ddf"),t.fr(this.qs.x/2,5,this.qs.x/2,this.Jh),t.fs("#963"),t.fr(0,5,this.qs.x,5),t.fs("#333"),t.fr(this.qs.x/4,0,this.qs.x/2,5),t.r()}},lt=class extends B{constructor(t,s,i){super(t,s),this.se=new C(12,18),this.ie=new C(4,12),this.he=new C(5,4),this.Nh=new C(10,40),this.ee=i,this.se=s}F(t){super.F(t)}K(t,s={v:new C,r:0}){super.K(t);var i=this.ee.re.Qh;t.s(),t.lw(1),t.globalAlpha=this.et,t.tr(this.v.x,this.v.y-this.g),this.Us&&this.V(t),t.rot(s.r+this.k),t.fs(this.ee.Js),i.lL&&i.lR&&(t.s(),t.tr(-this.he.x/2-this.se.x/3,-2),t.rot(i.lL.r),t.fr(0,this.he.y,this.he.x,this.he.y/3),t.r(),t.s(),t.tr(-this.he.x/2+this.se.x/3,-2),t.rot(i.lR.r),t.fr(0,this.he.y,this.he.x,this.he.y/3),t.r()),t.s(),t.rot(i.b.r),t.fs(this.ee.js),t.fr(-this.se.x/2+i.b.v.x,-this.se.y+i.b.v.y,this.se.x,this.se.y),t.fs(this.ee.Js),2==this.ee.D?(t.s(),t.tr(0,-this.se.y+this.se.y/4),t.rot(-w/2),t.fr(-this.ie.x/2,0,this.ie.x,1.2*this.ie.y),t.r()):this.ee.Th||(t.s(),t.tr(0,-this.se.y+this.se.y/4),t.rot(-20*i.b.r),t.fr(-this.ie.x/2,0,this.ie.x,this.ie.y),t.r()),t.r(),t.r()}};class ut{static goToPosition(t,s=new C){let i=0,h=0,e=C.Ct(s,t.v);const r=e.Vs();return r>1&&(i=e.Ks()-t.ne,h=1),{m:h,r:i,d:r}}}class ft extends a{constructor(t=new C){super(t),this.js=O.js[Math.random()*O.js.length>>0],this.Ns=O.Ns,this.Ws=O.Ws,this.Is=O.Is,this.ae=new C(16,18),this.oe=new C(1,p(15,20)),this.se=new C(12,18),this.he=new C(4,4),this.ie=new C(4,12),this.Nh=new C(10,40),this.ce=!1,this.le=!1,this.ue=!1,this.fe=15,this.we=0,this.it=0,this._e=4,this.Ri=!1,this.de=0,this.Th=!1,this.mi=!1,this.zi=!1,this.pe=new n,this.Hi=new n,this.Li=new n,this.ve="#00ff00",this.Zh=0,this.ne=Math.PI,this.me=ut.goToPosition,this.D=1,this.ot=this.X=100,this.I=10,this.Y=2,this.be=new it(20,et),this.ge=new it(20,rt),this.ke=new it(16,nt,!1),this.re=this.be,this.xe()}get rt(){return this.it+this.g}xe(){this.Js=O.Js[Math.random()*O.Js.length>>0],this.bi=M(),this.Ce()}ye(t){let s=this.me(this,this.Ae);this.Ee(s.r),this.Se(s.m*t),2>s.d&&(this.Ae=null)}Ee(t){this.ne+=t}Se(t){this.j.B(C.Fs(this.ne,t))}zh(){return 0===this.g}Bh(){return 0===this.g&&this.Th}F(t){this.we=f.max(this.we-t,0),this.At&&3==this.At.xt&&this.De(this,5,!0),this.Z.x>0&&!this.Me&&(this.Me=!0),0>this.Z.x&&this.Me&&(this.Me=!1),null==this.Ae||this.pe.active()||this.ye(t),this.Oe(),this.Pe.F(t),this.Be.F(t),this.Wh.F(t),this.He(),this.re.F(t),this.le=this.re==this.ke,this.le&&!this.ue&&(this.ue=!0,setTimeout(()=>{this.ue=!1},400)),this.Th&&this.Z.ut(.5),1==this.Zh&&30>this.se.y&&this.Te(1.01),2==this.Zh&&this.se.y>10&&this.Te(.99),0==this.Zh&&(this.se.y-Ct.ze.se.y>1?this.Te(.99):Ct.ze.se.y-this.se.y>1&&this.Te(1.01)),this.Hi.elapsed()&&(this.Zh=0,this.Hi.unset()),this.Pe.mi=this==Ct.Os&&this.mi,this.Li.elapsed()&&(this.mi=!1,this.Li.unset()),super.F(t)}Te(t=1){this.se=this.se.ut(t),this.ae=this.ae.ut(t),this.Ce(),this.Be.ie=this.Be.ie.ut(t),this.Be.he=this.Be.he.ut(t)}nt(){if(this.A){for(this.at&&(this.at.A=!1),this.ce&&this.Le(),this.Th&&this.Re(new st(this.v.O(),this.Nh)),this.Ri&&this.Re(new tt("🔑",this.v.O()));this.de>0;){let t=new tt("💎",this.v.O());this.de--,Ct.bt.Fe.push(t),this.Re(t,2,20)}super.nt()}}Re(t,s=m(.5,1.5),i=4){this.Ke(t,40,s,i),Ct.bt.wi(t)}Le(){var t=new z(this.v.O(),this.ae,this);t._i=!0,t.xi(),t.Js=this.Pe.Js,t.Ns=this.Pe.Ns,t.$=3e3,t.di=this.D;var s=new lt(this.v.O(),this.se,this);s.ie=this.ie,s.he=this.he,s.$=3e3,s.G=e+.03,this.Ke(s,this.g+1,12,20,-.25),t.G=e+.03,this.Ke(t,this.g+1,12,20,.25);let i=Ct.bt;i.wi(t),i.wi(s)}Ce(){null==this.Be&&(this.Be=new lt(new C(0,9),this.se,this)),null==this.Pe&&(this.Pe=new z(new C(0,this.Be.v.y-this.se.y),this.ae,this)),this.Pe.Js=this.Js,this.Pe.bi=this.bi,this.Be.Js=this.Js,this.Pe.v.y=this.Be.v.y-this.se.y,this.Pe.di=this.D,2==this.D&&(this.Pe.Js=this.Js,this.Pe.Ws=P.Ws,this.Pe.Is=P.Is),this.Wh=new ct(new C(1,this.Be.v.y),this.Nh),this.Pe.P=this.Be.P=this.Wh.P=this}Ke(t,s,i,h,e=10){t.dt(),t.j.B(C.Fs(p()*w*2).ut(e)),t.g=s,t.J+=i,t.C=v()/h,t.Us=!0}He(){[this.ke].includes(this.re)&&!this.re.Xh||(this.Z.Vs()>.1?this.re=this.ge:this.re=this.be)}De(t,s=1,i=!1){const h=C.Ct(t.v,this.v).Zs().ut(-100);this.j.B(h),(t.Z.Vs()>5||i)&&0==this.J&&(this.J+=5)}Kh(t){if(this.A&&!this.ue&&(this.De(t,1,!1),t==Ct.bt.Os&&1==t.Zh&&(this.G=e+.1,this.De(t,2,!0)),t==Ct.bt.Os&&this.Th&&t.Z.O().Vs()>.5)){var s=new st(t.v.O(),this.Nh);s.Jh=t.Wh.Jh,this.Re(s),this.Th=!1,this.pe.set(3)}}Oe(){if(!this.A)return;let t=[];t.push({t:1,c:new J(this,new C(-10,-12-this.rt+this.g),20,15,50,!0)}),this.Th&&this.le&&t.push({t:2,c:new J(this,new C(0+(this.Me?0:-1)*(this.Wh.Jh+20),-35-this.rt+this.g),this.Wh.Jh+20,40,50,!0)}),t.forEach(t=>{Ct.bt.Ch.mh(t.c).forEach(s=>{s.gh.Kh(this),s.gh instanceof ft&&Ct.Ve(this,s.gh,t.t)})})}Hh(){Ct.Vh(5,this,null),this.re=this.ke,this.ke.Uh=0;var t=this.Me?1:-1,s=Ct.bt.Ch.mh(new J(this,new C(t*(this.se.x/2+10+(this.Me?0:36)),-30),36,20));s.length>0&&s.forEach(t=>{0===t.g&&t.gh.Kh(this,!1)}),this.we=this.fe}K(t){if(Ct.bt.Ms(C.B(this.v,new C(0,-this.rt)))){super.K(t);var s=this.re.Qh;if(t.s(),t.tr(0,-10),t.lw(1),t.tr(this.v.x,this.v.y-this.rt),this.At&&(t.fs("rgba(0,0,0,0.5"),t.bp(),t.ellipse(0,12+this.g,10,5,0,0,2*w),t.fill()),this.Me||t.scale(-1,1),this.Be.K(t,s.b),this.Pe.K(t,s.h),this.Th&&this.Wh.K(t,s.s),t.ta(),t.font="bold 15px serif",this.Ri&&(t.bp(),t.ft("🔑",0,4)),this!=Ct.bt.Os&&this.de>0&&(t.bp(),t.ft("💎",0,4),y&&(this.Me||t.scale(-1,1),t.st(this.de,0,0,20))),Ct.bt instanceof pt&&100==this.X&&90>this.ot||300==this.X&&250>this.ot){this.Me||t.scale(-1,1),t.lineWidth=2;let s=20,i=this.se.y+this.ae.y;t.bp(),t.ss("#fff"),t.mt(0-s/2,0-i),t.lt(0+s/2,0-i),t.stroke(),t.bp(),t.strokeStyle=this.Ns,t.mt(0-s/2,0-i),t.lt(0-s/2+s*(this.ot/this.X),0-i),t.stroke()}t.r()}}}var wt=class extends a{constructor(t=new C,s=new C(10,40)){super(t),this.qs=s}K(t){t.s(),t.tr(0,-10),t.lw(1),t.globalAlpha=this.et,t.tr(this.v.x,this.v.y-this.rt),t.rot(this.k),t.lw(2),t.fs("#5B3017"),t.fr(0,-this.qs.y,this.qs.x/2,this.qs.y),t.fs("#875638"),t.fr(this.qs.x/2,-this.qs.y,this.qs.x/2,this.qs.y),t.r()}};class _t extends ft{constructor(t=new C){super(t),this._e=1,this.D=2,this.js=P.js[Math.random()*P.js.length>>0],this.Js=P.Js[Math.random()*P.Js.length>>0],this.Ns=this.Pe.Ns=P.Ns,this.Ce(),this.Pe.di=2,this.Pe.Ws=P.Ws,this.Pe.Is=P.Is,this.be=new it(20,at),this.ge=new it(20,ot),this.I=.8}}var dt=class extends a{constructor(t,s,i){super(t),this.qs=s,this.Ze=i,this.$=250}F(t){super.F(t),this.J+=2}K(t){t.s(),t.tr(this.v.x,this.v.y),t.bp(),t.st(this.Ze,0-this.qs.x/2,0+this.qs.y/2-this.g,12,"Helvetica"),t.r()}},pt=class extends ${constructor(t,s=new o,i=new ft){super(),this.Fi=[],this.Ki=[],this.je=[],this.Fe=[],this.Je=new n,this.Ne=!0,this.We=!1,this.Vi=0,this.Ie=32,this.Ue=[],this.qe=[],this.Ye=[],this.Ge=[],this.Qe=!1,this.Xe=()=>new Promise((t,s)=>{this.vt=new K(this.Es,{x:this.Ti.os.x,y:this.Ti.os.y}),null!=this.vt?t("OK"):s(Error("It broke"))}),this.Es=t,this.Ti=s,this.Os=i,this.Os.v=new C,this.$e=new F,this.sr=new a,this.Xe(this).then(()=>{this.ds()})}ds(){if(y&&(this.Oh.Qi=1500),this.R(this.sr),this.R(this.vt),6==this.Ti.Et)for(let t=0;t<D.x;t++)for(let s=0;s<D.y;s++)if(0==s||s==D.y-1||0==t||t==D.x-1){let i=this.vt.pt(new C(t,s).kt());i.xt=3,i.yt=18,i.ys=!0}if(this.Ti.Et>6){let t=new tt("🍄",vt());t.g=50,this.sr.R(t)}const t=new C(this.Ti.vs.x,this.Ti.vs.y);let s,i,h,e;if(s=this.Ti.ls,this.ir=this.vt.pt(s),this.ir.xt=2,this.ir.yt=30,this.ir.ys=!0,!this.Ti.Yt){if(i=this.Ti.us,this.hr=this.vt.pt(i),this.hr.yt=30,this.hr.ys=!0,!this.Ti.Ut){let t=new tt("🔒",this.hr.v);t.v=this.hr.v.O().B(new C(0,-15)),t.g=50,this.sr.R(t)}if(h=this.Ti.ws,this.er=this.vt.pt(h),this.er.yt=30,this.er.ys=!0,!this.Ti.Ut){let t=new tt("🔑",this.er.v);t.v=this.er.v.O().B(new C(0,-15)),t.g=50,this.sr.R(t)}}this.nr=this.vt.pt(t),this.Ti.qt||this.Ti.Yt||(this.Ti.Yt||(this.nr.yt=-500),this.nr.ys=!0,this.nr.xt=0,this.nr&&(this.ar=new l(this.nr.Ss.x-1.4,this.nr.Ss.y-1.3,this.nr.yt,this.nr.Es,1),this.ar.yt=3,this.sr.R(this.ar))),e=this.Ti.St>this.Ti.Et?_(new C(s.x+2.5,s.y+.5)):_(t.B(new C(1.5,-.5))),this.Os.v=e,this.Os.Th=this.Ti.or,this.Ti.Yt&&(this.Os.Th=!1),this.Os.cr=!1,(this.Ti.Et<this.Ti.St||this.Ti.qt)&&(this.Os.g=1500),this.sr.R(this.Os);let r=0,n=0;for(;r++<this.Ti.Tt;){let t=p()>.8,s=t?new st(new C,new C(12,50)):new st;if(s.v=_(this.Ti._s).B(new C(t?4:0,0)),s.g=30,s.j.B(C.Ls().ut(10)),s.k=p(-1,1)*w/4,this.je.push(s),this.sr.R(s),++n>1e3)break}for(this.lr(this.je,"💗",this.Ti.Ht),this.lr(this.Fe,"💎",this.Ti.zt-this.Ti.Lt);this.Fi.length<this.Ti.Bt;){let t=0;var a=vt();if(C.Rs(a,this.Os.v)>this.Ti.os.x*S.x/4){let t=new ft(a);t.g=20,t.Z.B(new C(p(-1,1),p(-1,1)).ut(p(.1,.5))),this.Fi.push(t),this.sr.R(t)}if(++t>1e3)break}if(this.ur=null,!this.Os.zi&&(Ct.wr||this.Ti.Et>2)){let t=new tt("🧭",vt());Ct.wr&&(t.v=this.Os.v.O().B(C.Ls().ut(60))),t.g=50,this.sr.R(t)}if(Ct.wr&&this.Ti.Et>=0||!Ct.wr&&this.Ti.Et>2){let t=new tt("🥽",vt());Ct.wr&&(t.v=this.Os.v.O().B(C.Ls().ut(60))),t.g=50,this.sr.R(t)}this.Ti.Yt&&X(4,.4,()=>{})}lr(t,s="",i=0){let h=0,e=0;if(this.Os)for(;i>e;){let i=vt(),r=t.filter(t=>50>C.Rs(i,t.v)).length>0,n=0==this.je.filter(t=>50>C.Rs(i,t.v)).length,a=!this.nr||C.Rs(i,this.nr.v)>50,o=!this.er||C.Rs(i,this.er.v)>50,c=!this.ir||C.Rs(i,this.ir.v)>50;if(!r&&n&&a&&c&&o){let h=new tt(s,i);t.push(h),this.sr.R(h),e++}if(++h>1e3)break}}wi(t){this.sr.R(t)}_r(t,s){this.sr.R(new dt(t.O(),new C(4,4),s))}F(t){if(!this.Ti.Yt&&this.We&&V.Gi&&(this.Sh=!0),this.$e.F(t),null!=this.Os){if(0==this.Os.ot){if(!this.We){let t=new _t(this.Os.v.O());t.bi=this.Os.bi,t.Ce(),t.g=20,t.Z.B(C.Ls().ut(p(.1,.5))),this.Ki.push(t),this.sr.R(t),this.Os=t,this.We=!0}this.$e.Si=!0}if(40>this.Os.ot&&!this.We&&Ct.Vh(12,this.Os,null),this.Ti.qt||this.Ti.Yt||this.Os.At!=this.nr||!this.dr(this.Os)||this.Dh||(this.Dh=!0),0==this.Os.g&&this.Ti.Pt.length>=1&&this.Ti.Pt[this.Vi]>0&&0==this.Ki.length){let t=0;for(;this.Ki.length<this.Ti.Pt[this.Vi];){var s=vt();if(C.Rs(s,this.Os.v)>200){let t=new _t(s);this.Ti.Et>=8&&p()>.7?(t.Zh=2,t.I=1.8):(7==this.Ti.Et&&p()>.9||this.Ti.Et>7&&p()>.7)&&(t.Zh=1,t.ot=t.X=300,t.I=.4,t._e=2),t.g=20,this.Ki.push(t),this.sr.R(t)}if(++t>1e3)break}if(this.Vi>0&&this.Ti.Pt.length>1){if(this.$e.ji("Wave "+(this.Vi+1)+" of "+this.Ti.Pt.length),setTimeout(()=>{this.$e.Ji(),this.Vi+=1},3e3),Ct.wr&&this.Ti.Et>4){let t=new tt("🍄",vt());t.g=50,this.sr.R(t)}}else this.Vi+=1}if(this.Ti.Yt&&this.Vi>=this.Ti.Pt.length-1&&0==this.Ki.length&&(this.$e.Di=!0,setTimeout(()=>{this.Qe=!0},2e3),this.Qe&&this.pr(),this.Ye.forEach(s=>s.F(t))),this.Ti.Ut){if(this.Os.Ri=!1,!this.ur&&this.ir){let t=new l(this.ir.Ss.x-.65,this.ir.Ss.y-.65,this.ir.yt-20,this.ir.Es,2);this.sr.R(t),this.ir.xt=0,this.ur=new wt(this.ir.v.O(),new C(3,200)),this.ur.g=200,Ct.bt.wi(this.ur),this.Je.set(.5)}this.Os.At&&this.ir&&40>C.Rs(this.Os.At.v,this.ir.v)&&(this.Os.v=this.ir.v.O().B(new C(-3,S.y/2-10)),this.Os.Z.wt()),(this.dr(this.Os)&&this.Os.At&&this.Os.At===this.ir&&this.Je.elapsed()&&!this.Os.cr||this.Os.cr)&&(this.Os.cr=!0,X(9,3,()=>{W(.2,.05,329.6276,.01,.29,1,0,1.6,1.2,0,-25,.15,20,0,0,0,0,.71,.18,.2)}),this.ir.yt+=1.5),this.Os.At&&this.Os.At.yt>120&&(this.Sh=!0)}this.Ki=this.Ki.filter(t=>t.A),this.Fi=this.Fi.filter(t=>t.A),this.je=this.je.filter(t=>t.A),this.Fe=this.Fe.filter(t=>t.A),this.Fi.forEach(t=>{if(null==t.Ae){let s=vt();C.Rs(s,t.v)>20&&(t.Ae=s)}}),this.Ki.sort(()=>p()-.5).some(t=>{t.Ae=null;let s=this.Fi.filter(s=>100>C.Rs(t.v,s.v)).sort(s=>C.Rs(s.v,t.v));s.length>0?t.Ae=s[0].v.O():this.Os.A&&this.dr(this.Os)&&(t.Ae=this.Os.v.O())}),this.je.forEach(t=>{null!=t.vr&&(t.v,t.vr.v)}),this.sr._=this.sr._.sort((t,s)=>s.v.y-t.v.y),super.F(t)}}mr(t){return 2==t.D}dr(t){return 1==t.D}br(t){return t==Ct.bt.Os}bs(){this.Ti.Rt=this.Fi.length,this.Ti.Pt=[this.Ki.length],this.Ti.Bt=this.Fi.length,this.Ti.zt=this.je.filter(t=>t instanceof tt&&"💎"==t.Rh).length}Ve(t,s,i){t==this.Os&&2==i&&this.mr(s)?Ct.Vh(8,t,s,.3,s.S):2==i&&t==this.Os&&this.dr(s)?Ct.Vh(9,t,s):this.mr(t)&&this.dr(s)&&s!=this.Os?Ct.Vh(11,t,s):this.mr(t)&&s===this.Os&&(this.Os.ue||1==this.Os.Zh||Ct.Vh(10,t,s,.4))}gr(t,s,i){let h=Ct.bt.Os;if(null==i||i.A)switch(t){case 14:h.ot<h.X&&(X(10,.4,()=>{W(.5,.05,288,.02,.07,.15,2,.87,-4.6,0,-317,.04,0,0,0,0,0,.71,.03,0)}),h.ot=h.X,this._r(h.v,i.Rh),i.nt());break;case 12:q();break;case 10:Ct.bt.Oh.fh(20),q(),i.ot=f.max(0,i.ot-10),i.ot>0||Ct.bt.Oh.fh(100),this.gr(15,s,i);break;case 15:break;case 11:if(i.ot=f.max(0,i.ot-25),0==i.ot){let t=new _t(i.v.O());t.bi=i.bi,t.g=20,t.Z.B(C.Ls().ut(p(.1,.5))),t.Th=!1,this.Ki.push(t),this.sr.R(t)}break;case 5:h.Wh.Fh(h);break;case 9:case 8:i.ot=f.max(0,i.ot-h.Wh.jh/i._e),i.ot>0?300==i.X?X(3,0,()=>{W(1,.05,220,.02,0,.1,0,.8,.1,.2,-50,.02,-.01,.1,-1,0,0,.9,.03,.01)}):X(3,0,()=>{W(.5,.05,90,.02,.02,.07,4,1,0,0,0,0,0,2,50,0,0,.7,.01,0)}):(X(30,.8,()=>{W(.5,.05,120,.03,.12,.07,4,1,1,1.1,150,0,.01,2,45,0,0,.2,.04,0)}),i.ce=!0,2==i.D&&Ct.kr(1),1==i.D&&Ct.xr(1));break;case 16:s==Ct.Os?(Ct.Cr(1),Ct.Ti.zt==Ct.Ti.Lt?X(10,.4,()=>{W(.5,.01,518,.01,.1,.22,1,1.73,0,0,172,.06,0,0,0,0,0,.57,.27,.05)}):G()):s.de++,i.nt();break;case 2:X(6,.4,()=>{W(.4,.2,150,.05,0,.05,0,1,-1,0,0,0,0,4,0,0,0,1,.02,0)});break;case 3:X(4,.3,()=>{W(.2,0,300,.1,.3,.1,0,1.61,0,0,286,.06,.18,0,0,0,0,.4,.1,.09)}),this._r(i.v,i.Rh);break;case 4:X(5,.3,()=>{W(.2,0,850,.1,.3,.1,0,1.61,0,0,286,.06,.18,0,0,0,0,.4,.1,.09)}),i.Rh="🔓",this._r(i.v,i.Rh);break;case 5:Y()}}K(t){if(this.Ne&&(t.globalCompositeOperation="source-over"),this.Os&&this.Oh.vh(this.Os.v.x,this.Os.v.y+this.Os.g-this.Os.rt),this.Oh.wh(t),super.K(t),this.Os.zi){let s=this.Os.v.O().B(new C(0,-this.Os.rt+this.Os.g));if(t.lw(4),this.Ki.forEach(i=>{let h=new C(i.v.x,i.v.y-i.rt),e=C.Ct(h,s);t.bp(),t.ss("rgba(10,255,10,.2)"),t.ellipse(s.x,s.y,30,15,0,e.Ks()-.2,e.Ks()+.2),t.stroke()}),this.ir&&this.hr&&!this.Os.cr&&(this.hr&&this.Os.Ri||this.Ti.Ut)){let i=this.Ti.Ut?this.ir.M():this.hr.M(),h=C.Ct(i,s);t.bp(),t.lw(2),t.ss("rgba(255,255,255,.2)"),t.s(),t.tr(s.x,s.y),t.rot(h.Ks()),t.setLineDash([10,20]),t.mt(30,0),t.lt(0,0),t.mt(30,0),t.lt(25,3),t.mt(30,0),t.lt(25,-3),t.stroke(),t.r()}}y&&this.Ch.K(t),this.Oh.dh(t);let s=Ct.bt.Os;if(s&&this.Ne&&!this.Ti.Yt){let c=6+f.abs(f.cos(e/20+10*p()));s.mi&&this.Ie>4&&(this.Ie*=.98),!s.mi&&24>this.Ie&&(this.Ie*=1.02);var i=A,h=E,r=Ct.yr.cloneNode().getContext("2d"),n=r.createRadialGradient(i/2,h/2,i/this.Ie+i/this.Ie*c,i/2,h/2,0);n.addColorStop(0,"transparent"),n.addColorStop(1,"white"),r.fillStyle=n,r.filter="blur(5px)",r.fr(0,0,i,h);var a=A/2,o=E/2;t.globalCompositeOperation="destination-in",t.drawImage(r.canvas,a-i/2,o-h/2),t.globalCompositeOperation="lighten",t.fr(0,0,i,h),t.globalCompositeOperation="source-over"}this.$e.K(t)}pr(){this.Ti.$t||(this.Ti.gs(),this.Ti.xs()),this.Ue.length<f.min(100,this.Ti.Zt)?this.Ar(this.Ue,new C(0,-50),O):this.Ge.length<f.min(100,this.Ti.Vt)?this.Er(new C(0,120)):this.Ye.length<f.min(100,this.Ti.jt)?this.Sr(this.Ye,new C(-150,120),P):this.qe.length<f.min(100,this.Ti.Jt)&&this.Sr(this.qe,new C(150,120),O)}Ar(t,s,i){var h=new ft(this.ir.v.O().B(s));h.$=-1,h.dt(),h.Z.B(C.Fs(p()*w*2).ut(40*p())),h.g=20,h.J+=3,h.C=v()/2,Ct.bt.wi(h),this.Ue.push(h)}Er(t,s){var i=new tt("💎",this.ir.v.O().B(t));i.Fh=!0,i.$=-1,i.dt(),i.Z.B(C.Fs(p()*w*2).ut(40*p())),i.g=20,i.J+=3,i.C=v()/2,Ct.bt.wi(i),this.Ge.push(i)}Sr(t,s,i){var h=new z(this.ir.v.O().B(s),new C(16,18),this);h.Ws=i.Ws,h.Is=i.Is,h.Ns=i.Ns,h.Js=i.Js[Math.random()*i.Js.length>>0],h.bi=M(),i.Ns==P.Ns&&(h.di=2,h.D=2,h.Js=P.Js[Math.random()*P.Js.length>>0]),h._i=!0,h.xi(),h.$=-1,h.G=e+.03,h.dt(),h.Z.B(C.Fs(p()*w*2).ut(40*p())),h.g=20,h.J+=3,h.C=v()/2,h.Us=!0,Ct.bt.wi(h),t.push(h)}};function vt(){return _(new C(m(0,D.x-1),m(0,D.y-1)))}const mt="EscapeFromDeathHole",bt=()=>localStorage.getItem(mt)?JSON.parse(localStorage.getItem(mt)):{},gt=(t,s)=>{const i=bt();i[t]=s,(t=>{localStorage.setItem(mt,JSON.stringify(t))})(i)};var kt={save:gt,get(t="",s){let i=bt()[t];return null==i&&gt(t,s),i||s}},xt=class extends ${constructor(t){super(),this.Dr=!1,this.Mr=-.098,this.Os=t,this.$e=new F,this.$e.K=t=>{t.fs("#111"),t.rr(9,9,A-18,E/3,20),t.ta(),t.st("Escape from",A/2-9,E/8-E/18,A/20,"sans-serif","#ED1B23","#fff"),t.st("DEATH HOLE",A/2-9,E/8+E/10,A/8,"sans-serif","#ED1B23","#fff"),t.fs("#896A44"),t.fr(0,E-E/4,A/2-100,E/3),t.fr(A/2+100,E-E/4,A/2-100,E/3),t.fs("#438742"),t.fr(0,E-E/4,A/2-100,50),t.fr(A/2+100,E-E/4,A/2-100,50),this.Dr||(t.fs("#444"),t.fr(A/2-100,E-E/4,200,25));let s=1*E/30;t.st("Use arrow keys or WASD to move",A/2,E/2-4*s,20),t.st("Click or Space to action",A/2,E/2-3*s,20),Ct.wr?(t.st("👋 Hello Coil member!",A-A/8,E/2+2*s,18),t.st("Click on player",A-A/8,E/2+4*s,18),t.st("to change color",A-A/8,E/2+5*s,18)):(t.st("Coil members",A-A/8,E/2+3*s,18),t.st("can change",A-A/8,E/2+4*s,18),t.st("player colors",A-A/8,E/2+5*s,18),t.st("and get extra powerups",A-A/8,E/2+6*s,18)),t.st("Press Enter to start",A/2,E/2+E/2.5,40+3*f.cos(this.$e.Oi.p100()))},this.Oh.Xi=new C(24,-22),this.Oh.Qi=this.Oh.Rs=400,this.Os.v=new C(-100,30),this.R(this.Os)}F(t){super.F(t),this.$e.F(t),this.Os.j=new C(30,0),this.Oh.th.mid.x>this.Os.v.x?this.Oh.Xi=new C(24-100*e,-22):this.Os.j.wt(),V.Yi&&this.Os.zh()&&Ct.wr&&this.Or(),V.Gi&&!this.Dr&&(this.Dr=!0,setTimeout(()=>{this.Sh=!0},2500)),this.Dr&&(this.Mr*=1.1,this.Os.v.y-=this.Mr)}K(t){this.Oh.wh(t),super.K(t),y&&this.Ch.K(t),this.Oh.dh(t),this.$e.K(t)}Lh(){super.Lh(),Ct.wr&&this.Or(),kt.save("skinColor",Ct.ze.Js),kt.save("hairColor",Ct.ze.bi)}Or(){G(),this.Os.xe(),Ct.ze.bi=this.Os.bi,Ct.ze.Js=this.Os.Js}};document.getElementById("btnAudio");var Ct=new class{constructor(){this.Ti=new o,this.Pr=!1,this.Br=[],this.Hr=new N,this.Tr=[],this.zr=!1,this.musicStarted=!1,this.Lr=!1,this.Rr=t=>new Promise((s,i)=>{t.Ti.ns.forEach(s=>{const i=(t=>{var s=document.createElement("canvas"),i=s.getContext("2d");i.imageSmoothingEnabled=!0,s.width=(S.x+1)*t.length,s.height=60*S.y+1830;for(var h=0;h<t.length;h++)for(var e=t[h],r=h*(S.x+1)+(S.x+1)/2,n=0;60>n;n++){var a=n,o=S.y*n+n*(n+1)/2;u(i,r,o,a,e,2==h)}return s})(s.c);t.Br.push(i)}),t.Br.length>0?s("OK"):i(Error("It broke"))}),this.Ih=performance.now(),this.yr=document.getElementById("game"),this.Fr=this.yr.getContext("2d"),this.yr.width=A,this.yr.height=E,oncontextmenu=()=>!1,onscroll=t=>t.preventDefault();const t=t=>()=>{this.Ph=t};this.yr.addEventListener("mousedown",t(!0)),this.yr.addEventListener("mouseup",t(!1)),this.Rr(this).then(()=>{this.Kr()}),this.ze=new ft(new C(0,0)),this.ze.js="#f00",this.ze.Js=kt.get("skinColor",O.Js[Math.random()*O.Js.length>>0]),this.ze.bi=kt.get("hairColor",M()),this.ze.Ce(),this.Os=new ft(new C(0,0)),this.Os.js=this.ze.js,this.Os.Js=this.ze.Js,this.Os.bi=this.ze.bi,this.Os.Ce(),this.yr.onmouseup=()=>{this.bt.Lh()},document.monetization&&document.monetization.addEventListener("monetizationstart",()=>{console.log("monetizationstart"),this.wr=!0})}Lh(){}Cr(t){this.Ti.Lt+=t}kr(t){this.Ti.Ft+=t}xr(t){this.Ti.Kt+=t}Vh(t,s,i,h=.3,e=""){(0==h||this.Hr.Ah(t+e))&&(this.bt instanceof pt&&this.bt.gr(t,s,i),0!=h&&this.Hr.Eh(t+e,h))}Ve(t,s,i){t.A&&s.A&&this.bt instanceof pt&&this.bt.Ve(t,s,i)}Kr(){this.Vr(),this.bt=new xt(this.Os),this.Zr()}Zr(){this.jr=requestAnimationFrame(this.Jr.bind(this))}Vr(){cancelAnimationFrame(this.jr)}Jr(t){this.jr=requestAnimationFrame(this.Jr.bind(this));var s=f.max(0,t-this.Ih);this.F(s),this.Ih=t,e=(r+=1)/60}Nr(){this.Vr(),this.Ti.or=this.bt.Os.Th,this.Ti.ms(),this.Wr(),this.Zr()}Ir(){this.Vr(),this.Ti.or=this.bt.Os.Th,this.Ti.ks(),this.Wr(),this.Zr()}Wr(){this.Ti.ds(),this.bt=new pt(this.Br[this.Ti.Et],this.Ti,this.Os),this.bt.Dh=!1,this.bt.We=!1,this.bt.Os.At=null}F(t){this.bt.F(t),(t=>{Q.F(t)})(t),this.Hr.F(t),this.bt.Sh&&(this.bt.Sh=!1,this.bt instanceof xt?this.Wr():this.bt instanceof pt&&(this.bt.We?(this.Vr(),this.Os=new ft,this.Os.js=this.ze.js,this.Os.bi=this.ze.bi,this.Os.Js=this.ze.Js,this.Os.Ce(),this.Wr(),this.Zr()):this.Nr())),this.bt.Dh&&(this.Ir(),this.bt.Dh=!1),this.K()}K(){var{Fr:t,bt:s}=this;t.clearRect(0,0,A,E),t.fs("rgba(0,0,0,1)"),t.fr(0,0,A,E),t.s(),s.K(t),t.r()}};i(2)}]);</script></body></html>
